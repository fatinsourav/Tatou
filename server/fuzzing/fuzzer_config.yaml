# ==========================================================
# Tatou Fuzzing Configuration
# Used by: test_fuzz_api.py
# ==========================================================

global:
  iterations: 20              # Number of mutations per request
  max_payload_size: 4096      # Max mutation size for fuzzed fields
  enabled: true               # Master switch for fuzzing

auth:
  # User creation fuzzing
  create_user_fields:
    - field: "email"
      type: "string"
      mutate: true
    - field: "login"
      type: "string"
      mutate: true
    - field: "password"
      type: "string"
      mutate: true

routes:
  - name: "upload_document"
    method: "POST"
    path: "/api/upload-document"
    fields:
      - name: "file"
        type: "pdf_bytes"
        mutate: true
      - name: "name"
        type: "string"
        mutate: true

  - name: "list_versions"
    method: "GET"
    path: "/api/list-versions"
    query_params:
      - "document_id"

  - name: "get_document"
    method: "GET"
    path: "/api/get-document"
    query_params:
      - "document_id"

  - name: "delete_document"
    method: "DELETE"
    path: "/api/delete-document"
    query_params:
      - "document_id"

  - name: "create_watermark"
    method: "POST"
    path: "/api/create-watermark"
    fields:
      - name: "document_id"
        type: "string"
        mutate: true
      - name: "method"
        type: "string"
        mutate: false
      - name: "secret"
        type: "string"
        mutate: true
      - name: "key"
        type: "string"
        mutate: true

  - name: "read_watermark"
    method: "POST"
    path: "/api/read-watermark"
    fields:
      - name: "document_id"
        type: "string"
        mutate: true
      - name: "method"
        type: "string"
        mutate: false
      - name: "key"
        type: "string"
        mutate: true

  - name: "watermark_methods"
    method: "GET"
    path: "/api/watermarking-methods"
    fields: []
